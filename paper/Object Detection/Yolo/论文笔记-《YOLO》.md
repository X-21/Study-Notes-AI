#YOLO

#翻译：http://noahsnail.com/2017/08/02/2017-8-2-YOLO%E8%AE%BA%E6%96%87%E7%BF%BB%E8%AF%91%E2%80%94%E2%80%94%E4%B8%AD%E6%96%87%E7%89%88/

### 概要

目标检测在实时性上存在很大的问题，主要限制于检测系统，常见的DPM和rcnn中的rpn都需要单独训练且速度还是达不到实时。
人眼在观察物体时却可以一眼就知道图像中的物体是什么，它们在哪里以及它们如何相互作用。
正是鉴于人眼的这种性能，提出yolo，只需要在图像上看一次，以预测出现的目标和位置。
单个神经网络在一次评估中直接从完整图像上预测边界框和类别概率。
基础YOLO模型以45帧/秒的速度实时处理图像，网络的一个较小版本，快速YOLO，每秒能处理惊人的155帧，同时实现其它实时检测器两倍的mAP。


### 架构

1.系统将输入图像分成S×S的网格。如果一个目标的中心落入一个网格单元中，该网格单元负责检测该目标。
2.每个网格单元预测这些盒子的B个边界框和置信度分数。如果该单元格中不存在目标，则置信度分数应为零。否则，我们希望置信度分数等于预测框与真实值之间联合部分的交集（IOU）。
3.每个边界框包含5个预测：x，y，w，h和置信度。(x，y)坐标表示边界框相对于网格单元边界框的中心。宽度和高度是相对于整张图像预测的。最后，置信度预测表示预测框与实际边界框之间的IOU。
4.图像分成S×S的网格，并且每个网格单元预测B个边界框，这些边界框的置信度以及C个类别概率。这些预测被编码为S×S×(B∗5+C)的张量（输出）。

在网络设计上没有过多的创新，主要受GoogLeNet图像分类模型的启发。

### 训练
1.预训练网络中增加卷积层和连接层可以提高性能，所以基于预训练模型添加了四个卷积层和两个全连接层，并且具有随机初始化的权重。（可学习扩展）
2.使用加权误差：
（1）在每张图像中，许多网格单元不包含任何对象。这将这些单元格的“置信度”分数推向零，通常压倒了包含目标的单元格的梯度。这可能导致模型不稳定，从而导致训练早期发散。
（2）平方和误差也可以在大盒子和小盒子中同样加权误差，大盒子小偏差的重要性不如小盒子小偏差的重要性。（为了部分解决这个问题，直接预测边界框宽度和高度的平方根，而不是宽度和高度）
（2）中的做平方根减少了大小盒子偏差的影响，有点类似于一种归一化。
3.学习率调整方法：
于第一个迭代周期，我们慢慢地将学习率从10−3提高到10−2。从高学习率开始，模型往往会由于不稳定的梯度而发散。（很多论文都提到这一点）
继续以10−2的学习率训练75个迭代周期，然后用10−3的学习率训练30个迭代周期，最后用10−4的学习率训练30个迭代周期。

### 架构

1.定位错误占YOLO错误的大多数，但是相比Fast R-CNN背景错误要少近9%，应该是因为yolo感受范围更大，容易判断出是不是背景
2.由于yolo在背景错误上有很好的表现，结合Fast R-CNN和YOLO得到了更高的mPA，但是在时间上开销并不会增加很多（因为yolo很快）
3.yolo在艺术品的检测上表现出了更好的泛化性能。
（1）R-CNN使用选择性搜索来调整自然图像的边界框提出。R-CNN中的分类器步骤只能看到小区域，并且需要很好的边界框提出。
（2）DPM在应用于艺术品时保持了其AP，因为它具有目标形状和布局的强大空间模型。
（3）像DPM一样，YOLO建模目标的大小和形状，以及目标和目标通常出现的位置之间的关系。
艺术品和自然图像在像素级别上有很大不同，但是它们在目标的大小和形状方面是相似的，因此YOLO仍然可以预测好的边界框和检测结果。
（R-CNN学习像素上的分布关系，而艺术品相对抽象，更多关注在形状和相互关系上）


### 思考
yolo的设计是对速度的追求，虽然在性能上相比state-of-art的faster-rcnn有所损失，但是在速度上得到了很大的提升。
